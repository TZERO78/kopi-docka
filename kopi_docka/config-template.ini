; ##############################################################################
; KOPI-DOCKA — Konfiguration
;
; @file:        config-template.ini
; @description: Zentrale Anwendungskonfiguration
; @author:      Markus F. (TZERO78) & KI-Assistenten
; @repository:  https://github.com/TZERO78/kopi-docka
; @version:     1.0.0
;
; ------------------------------------------------------------------------------
; Copyright (c) 2025 Markus F. (TZERO78)
; MIT-Lizenz: siehe LICENSE oder https://opensource.org/licenses/MIT
; ==============================================================================
; Hinweise:
; - Encoding: UTF-8
; - 'parallel_workers = auto' nutzt RAM/CPU-Heuristik
; - 'exclude_patterns' werden an tar '--exclude' durchgereicht
; ##############################################################################
[kopia]
# Local path or cloud URL for Kopia repository
#   s3://<bucket>/path, b2://<bucket>/path, azure://<container>, gs://<bucket>/path
repository_path = /backup/kopia-repository

# Repository password (auto-generated on first run if set to CHANGE_ME)
# IMPORTANT: Keep this password safe! Required for disaster recovery.
# Can be overridden by env KOPIA_PASSWORD.
password = CHANGE_ME_TO_A_SECURE_PASSWORD

# Compression (zstd|gzip|s2|none)
compression = zstd

# Encryption
encryption = AES256-GCM-HMAC-SHA256

# Kopia cache directory
cache_directory = /var/cache/kopi-docka

[backup]
# Base path for temporary kopia-docka data (supports ~)
base_path = /backup/kopi-docka

# Number of parallel workers ('auto' or 1-32)
parallel_workers = auto

# Container operation timeouts (seconds)
stop_timeout = 30
start_timeout = 60

# Max. Wartezeit je Teilaufgabe (Sekunden).
# Gilt pro Volume-Backup-Task. 0 = kein Timeout (empfohlen für große Volumes).
task_timeout = 0


# Disaster recovery bundle
update_recovery_bundle = false
recovery_bundle_path = /backup/recovery
recovery_bundle_retention = 3

# Exclusion patterns (comma-separated globs for volume tar)
# e.g. node_modules, *.tmp, cache, */__pycache__/*, .git, *.log
exclude_patterns =

# Optional hooks (absolute paths to executable scripts)
#   Env provided: KOPI_DOCKA_UNIT_NAME, KOPI_DOCKA_UNIT_TYPE
pre_backup_hook =
post_backup_hook =

[docker]
# Docker socket (needs r/w)
socket = /var/run/docker.sock

# docker compose timeout (seconds)
compose_timeout = 300

# Remove stopped containers before backup (dangerous)
prune_stopped_containers = false

[retention]
# Kopia retention policy (per unit)
daily = 7
weekly = 4
monthly = 12
yearly = 5

[logging]
# Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
level = INFO

# Optional log file path (leave empty to use only journald/console)
file = /var/log/kopi-docka.log

# Log rotation (file handler)
max_size_mb = 100
backup_count = 5